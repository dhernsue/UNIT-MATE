<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>UNIT-MATE • Calculator</title>
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#0f172a" />
<style>
  body{
    height:100vh;display:flex;justify-content:center;align-items:center;
    background:#1e1b4b;margin:0;font-family:Segoe UI,Arial;
  }
  .app{width:100%;max-width:420px;background:#111;padding:14px;display:flex;flex-direction:column;gap:12px;border-radius:14px;}
  .logo{text-align:center;margin-bottom:10px;}
  .logo img{max-width:120px;}
  .total{background:#000;padding:20px;border-radius:18px;font-size:22px;font-weight:bold;line-height:1.6em;
    box-shadow:inset 0 0 15px rgba(0,255,255,0.15);min-height:90px;}
  .total .title{color:#fff;font-size:22px;display:block;margin-bottom:6px;}
  .total .meter{color:#00ffff;display:block;font-size:20px;}
  .total .inch{color:#00ff00;display:block;font-size:20px;}
  .tabs{display:grid;grid-template-columns:repeat(4,1fr);gap:6px}
  .tab{padding:14px;font-weight:600;border-radius:12px;border:0;color:#fff;background:#333;transition:0.2s;font-size:16px}
  .tab.active{background:linear-gradient(45deg,#06f,#0ff);}
  .display{background:#000;padding:16px;border-radius:14px;min-height:80px;display:flex;flex-direction:column;justify-content:center;
    box-shadow:inset 0 0 12px rgba(255,255,255,0.08);}
  .trail{font-size:18px;color:#ccc;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
  .value{font-size:36px;font-weight:bold;color:#00ff00}
  .pad{flex:1;display:grid;grid-template-columns:repeat(3,1fr);gap:10px;align-content:start}
  .key{border:0;padding:20px;font-size:22px;font-weight:bold;border-radius:14px;background:#1f2937;color:#fff;transition:all 0.15s ease;}
  .key.ok{background:linear-gradient(45deg,#00ffcc,#00ff66);color:#000}
  .key.danger{background:linear-gradient(45deg,#ff416c,#ff4b2b);}
  .key:active{transform:scale(0.9);box-shadow:0 0 20px #0ff, 0 0 40px #f0f;}
</style>
</head>
<body>
<div class="app">

  <!-- ✅ Logo -->
  <div class="logo">
    <img src="logo.png" alt="UnitMate Logo" />
  </div>

  <!-- ✅ TOTAL Screen -->
  <div class="total" id="total">
    <span class="title">TOTAL</span>
    <span class="meter">Meter: <span class="num">0</span></span>
    <span class="inch">Inch: <span class="num">0</span></span>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab active" data-unit="mm">mm</button>
    <button class="tab" data-unit="inch">Inch</button>
    <button class="tab" data-unit="foot">Foot</button>
    <button class="tab" data-unit="meter">Meter</button>
  </div>

  <!-- Display -->
  <div class="display">
    <div class="trail" id="trail">0</div>
    <div class="value" id="value">0</div>
  </div>

  <!-- Keypad -->
  <div class="pad">
    <button class="key danger" data-act="ac">AC</button>
    <button class="key" data-act="mul">×</button>
    <button class="key" data-act="div">÷</button>
    <button class="key" data-num="1">1</button>
    <button class="key" data-num="2">2</button>
    <button class="key" data-act="sub">−</button>
    <button class="key" data-num="3">3</button>
    <button class="key" data-num="4">4</button>
    <button class="key" data-act="add">+</button>
    <button class="key" data-num="5">5</button>
    <button class="key" data-num="6">6</button>
    <button class="key ok" data-act="eq">=</button>
    <button class="key" data-num="7">7</button>
    <button class="key" data-num="8">8</button>
    <button class="key" data-num="9">9</button>
    <button class="key" data-num="0">0</button>
    <button class="key" data-act="dot">.</button>
    <button class="key" data-act="back">⌫</button>
  </div>
</div>

<script>
/* ✅ Conversion */
const U={
  mm:{toMM:v=>v,fromMM:v=>v},
  inch:{toMM:v=>v*25.4,fromMM:v=>v/25.4},
  foot:{toMM:v=>v*304.8,fromMM:v=>v/304.8},
  meter:{toMM:v=>v*1000,fromMM:v=>v/1000}
};
let currentUnit='mm',typing='',expressionMM='',expressionPretty='',lastOp='',resultShown=false;
const safeOps={add:'+',sub:'-',mul:'*',div:'/'};
const tabs=document.querySelectorAll('.tab'),trailEl=document.getElementById('trail'),valueEl=document.getElementById('value'),totalEl=document.getElementById('total');

/* ✅ Render */
function render(){
  trailEl.textContent=expressionPretty||'0';
  valueEl.textContent=typing?(typing+' '+currentUnit):(resultShown?'':0);
}
function showTotals(mm){
  if(!isFinite(mm))return;
  let meters=(mm/1000).toFixed(2);
  let inches=(mm/25.4).toFixed(2);
  totalEl.innerHTML=`<span class="title">TOTAL</span>
    <span class="meter">Meter: <span class="num">${meters}</span></span>
    <span class="inch">Inch: <span class="num">${inches}</span></span>`;
}
function fmt(n){return (+n).toLocaleString(undefined,{maximumFractionDigits:6});}
function commitTypedNumber(){
  if(!typing)return false;
  const n=parseFloat(typing);if(!isFinite(n))return false;
  const asMM=U[currentUnit].toMM(n);
  if(!expressionMM){expressionMM='('+asMM+')';expressionPretty=`${fmt(n)} ${currentUnit}`;}
  else if(lastOp){expressionMM+=lastOp+'('+asMM+')';expressionPretty+=' '+lastOp+' '+`${fmt(n)} ${currentUnit}`;lastOp='';}
  else{expressionMM='('+asMM+')';expressionPretty=`${fmt(n)} ${currentUnit}`;}
  typing='';return true;
}

/* ✅ Tabs */
tabs.forEach(btn=>btn.addEventListener('click',()=>{tabs.forEach(b=>b.classList.remove('active'));btn.classList.add('active');currentUnit=btn.dataset.unit;render();}));

/* ✅ Keypad */
document.querySelectorAll('.key').forEach(k=>{
  k.addEventListener('click',()=>{
    const num=k.dataset.num,act=k.dataset.act;
    if(num!==undefined){if(resultShown){expressionMM='';expressionPretty='';resultShown=false;}typing=(typing==='0')?num:(typing+num);render();return;}
    switch(act){
      case 'dot':if(!typing.includes('.'))typing=typing?typing+'.':'0.';render();break;
      case 'back':typing=typing.slice(0,-1);render();break;
      case 'ac':typing='';expressionMM='';expressionPretty='';lastOp='';resultShown=false;render();showTotals(0);break;
      case 'add':case 'sub':case 'mul':case 'div':commitTypedNumber();lastOp=safeOps[act];expressionPretty+=' '+lastOp+' ';render();break;
      case 'eq':
        commitTypedNumber();if(!expressionMM)return;let mmResult=0;
        try{if(!/^[0-9.+\-*/() ]+$/.test(expressionMM))throw 0;mmResult=Function('return ('+expressionMM+')')();}
        catch{mmResult=NaN}
        resultShown=true;
        if(isFinite(mmResult)){showTotals(mmResult);valueEl.textContent=`${fmt(mmResult)} mm`;trailEl.textContent=expressionPretty+' = '+fmt(mmResult)+' mm';}
        else{valueEl.textContent='Error';}
        expressionMM=isFinite(mmResult)?'('+mmResult+')':'';expressionPretty=isFinite(mmResult)?`${fmt(mmResult)} mm`:'';lastOp='';typing='';break;
    }
  });
});

render();showTotals(0);
</script>
</body>
</html>
